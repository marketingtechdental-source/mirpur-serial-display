<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mirpur Clinic Serial Display</title>
<style>
  body {
    margin: 0;
    font-family: 'Noto Sans', sans-serif;
    background: #101010;
    color: #fff;
  }

  header {
    background: #00897b;
    color: #fff;
    padding: 20px;
    text-align: center;
    font-size: 2.2em;
    font-weight: bold;
  }

  #clock {
    position: absolute;
    top: 15px;
    right: 30px;
    font-size: 1.6em;
    font-weight: 600;
  }

  table {
    width: 95%;
    margin: 20px auto;
    border-collapse: collapse;
    text-align: center;
    table-layout: fixed;
  }

  thead {
    background: #004d40;
    color: #fff;
  }

  th, td {
    border: 2px solid #00bfa5;
    padding: 5px 8px;
    font-size: calc(14px + 0.5vw);
    word-wrap: break-word;
  }

  tr:nth-child(even) { background: #1f1f1f; }
  tr:nth-child(odd) { background: #2c2c2c; }
  tr:hover { background: #00695c; }

  footer {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #004d40;
    text-align: center;
    padding: 10px;
    font-size: 1.2em;
  }
</style>
</head>
<body>

<header>ü¶∑ ‡¶Æ‡¶ø‡¶∞‡¶™‡ßÅ‡¶∞ ‡¶°‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶ø‡¶∞‡¶ø‡ßü‡¶æ‡¶≤ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</header>
<div id="clock"></div>

<table>
  <thead>
    <tr>
      <th>‡¶∞‡ßã‡¶ó‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
      <th>‡¶∏‡¶ø‡¶∞‡¶ø‡ßü‡¶æ‡¶≤‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü</th>
      <th>‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ</th>
      <th>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ</th>
    </tr>
  </thead>
  <tbody id="sheetBody">
    <tr><td colspan="4">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</td></tr>
  </tbody>
</table>


<script>
// Clock
function updateClock() {
  const now = new Date();
  document.getElementById('clock').textContent = now.toLocaleTimeString('en-US', { hour12: true });
}
setInterval(updateClock, 1000);
updateClock();

// Google Sheet JSON Web App URL
const sheetJSON = "https://script.google.com/macros/s/AKfycbwJ1QEzg9fZzp5lA8dUqx44bbutGDdqTWwCJwK590PWLtxQ5KndukIbJx83OUGQfIpg/exec";

// Function to format ISO string to 12-hour AM/PM
function formatTime(isoString) {
  if(!isoString) return '';
  const date = new Date(isoString);
  let hours = date.getHours();
  let minutes = date.getMinutes();
  const ampm = hours >= 12 ? 'PM' : 'AM';
  hours = hours % 12;
  hours = hours ? hours : 12;
  minutes = minutes < 10 ? '0'+minutes : minutes;
  return `${hours}:${minutes} ${ampm}`;
}

// Load Sheet Data
async function loadSheet() {
  try {
    const res = await fetch(sheetJSON);
    const data = await res.json();
    const tbody = document.getElementById('sheetBody');
    tbody.innerHTML = "";

    // Filter: ‡¶∂‡ßÅ‡¶ß‡ßÅ non-empty rows
    const filteredData = data.filter(row => {
      return row["‡¶∞‡ßã‡¶ó‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ"] || row["‡¶∏‡¶ø‡¶∞‡¶ø‡ßü‡¶æ‡¶≤‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü"] || row["‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ"] || row["‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ"];
    });

    // Add filtered rows
    filteredData.forEach(row => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${row["‡¶∞‡ßã‡¶ó‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ"] || ''}</td>
        <td>${formatTime(row["‡¶∏‡¶ø‡¶∞‡¶ø‡ßü‡¶æ‡¶≤‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü"])}</td>
        <td>${row["‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ"] || ''}</td>
        <td>${row["‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ"] || ''}</td>
      `;
      tbody.appendChild(tr);
    });

    if(filteredData.length === 0) {
      tbody.innerHTML = `<tr><td colspan="4">‚ùå ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø</td></tr>`;
    }

  } catch(err) {
    document.getElementById('sheetBody').innerHTML = `<tr><td colspan="4">‚ö†Ô∏è ‡¶∂‡¶ø‡¶ü ‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•</td></tr>`;
    console.error(err);
  }
}

// Initial load + auto-refresh every 5 sec
loadSheet();
setInterval(loadSheet, 5000);
</script>

</body>
</html>

